<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ú†Ø§Ù„Ø´ Ø§Ù„Ùˆ Ø°ØºØ§Ù„</title>
    <style>
        :root { --p: #ff4d00; --a: #ffae00; --s: #2ecc71; }
        body { margin: 0; background: #000; display: flex; justify-content: center; align-items: center; height: 100vh; font-family: Tahoma; overflow: hidden; user-select: none; }
        #game { width: 100vw; height: 100vh; max-width: 450px; background: radial-gradient(circle at top, #220000 0%, #050505 100%); display: flex; flex-direction: column; padding: 10px; box-sizing: border-box; }
        h3 { color: var(--a); text-align: center; margin: 2px 0; font-size: 14px; }
        .skip { display: block; text-align: center; text-decoration: none; color: #fff; background: rgba(255,77,0,0.1); border: 1px dashed var(--p); padding: 5px; margin: 5px auto; border-radius: 8px; font-size: 11px; width: 85%; animation: pulse 2s infinite; font-weight: bold; }
        @keyframes pulse { 0%,100% {opacity:1} 50% {opacity:0.5} }
        .stats { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 5px; margin-bottom: 8px; background: rgba(255, 255, 255, 0.05); padding: 8px; border-radius: 10px; border: 1px solid rgba(255,77,0,0.2); }
        .stat-box { display: flex; flex-direction: column; align-items: center; color: #fff; }
        .stat-v { font-weight: bold; font-size: 14px; }
        #tm { color: var(--p); font-size: 18px; transition: 0.3s; }
        .penalty-text { color: #ff0000 !important; transform: scale(1.2); }
        #grid { flex-grow: 1; display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(7, 1fr); gap: 4px; }
        .card { position: relative; cursor: pointer; perspective: 1000px; }
        .card-in { position: relative; width: 100%; height: 100%; transition: transform 0.4s; transform-style: preserve-3d; }
        .card.flip .card-in { transform: rotateY(180deg); }
        .face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; display: flex; align-items: center; justify-content: center; border-radius: 4px; font-size: 9px; font-weight: bold; border: 1px solid rgba(255,255,255,0.1); }
        .back { background: #1a1a1a; color: var(--p); font-size: 14px; }
        .front { background: #fff; color: #000; transform: rotateY(180deg); border: 1px solid var(--p); text-align: center; padding: 2px; }
        .match .front { background: var(--s)!important; color: white; border-color: #fff; box-shadow: 0 0 15px var(--p); }
        #ov { display: none; position: absolute; inset: 0; background: rgba(0,0,0,0.95); z-index: 10; flex-direction: column; align-items: center; justify-content: center; color: white; }
        .btn { background: var(--p); color: white; border: none; padding: 10px 20px; border-radius: 20px; font-weight: bold; margin-top: 10px; text-decoration: none; cursor: pointer; }
    </style>
</head>
<body>

<div id="game">
    <h3>ğŸ”¥ Ú†Ø§Ù„Ø´ Ø§Ù„Ùˆ Ø°ØºØ§Ù„ Ø¨Ø§ Û³ Ú©ÛŒØ³Ù‡ Ø¬Ø§ÛŒØ²Ù‡ ğŸ”¥</h3>
    <a href="https://aloozoghal-hash.github.io/alozoghal/" class="skip">ğŸ¤šÙ†ÙØªØ±Ù… Ø³Ø®ØªÙ‡ ÙˆÙ„Ø´ Ú©Ù† ÛŒØ§Ù… Ø°ØºØ§Ù„ Ø§ÙØ³ÙˆÙ†Ù…ğŸ¤š</a>
    <div class="stats">
        <div class="stat-box"><span style="font-size:9px">Ø²Ù…Ø§Ù†</span><span id="tm" class="stat-v">40</span></div>
        <div id="msg" style="color:var(--a); font-size:10px; align-self:center;">Ø¢Ù…Ø§Ø¯Ù‡ØŸ</div>
        <div class="stat-box"><span style="font-size:9px">Ø§Ù…ØªÛŒØ§Ø²</span><span id="sc" class="stat-v">1000</span></div>
    </div>
    <div id="grid"></div>
    <div id="ov">
        <h2 id="final-msg"></h2>
        <div id="reward" style="display:none"><a id="wa" href="#" target="_blank" class="btn" style="background:#25D366">ğŸ“± Ø¯Ø±ÛŒØ§ÙØª Ø¬Ø§ÛŒØ²Ù‡</a></div>
        <button onclick="init()" class="btn">Ø¯ÙˆØ¨Ø§Ø±Ù‡ (Ú†ÛŒØ¯Ù…Ø§Ù† Ø¬Ø¯ÛŒØ¯) ğŸ”„</button>
    </div>
</div>

<script>
(function() {
    const locs = ['Ø§Ø´Ú©ÙØª Ø³Ù„Ù…Ø§Ù†','Ú©ÙˆÙ„ÙØ±Ø­','Ø³ÙˆØ³Ù†','Ø¯Ù‡Ø¯Ø²','Ø­Ø§ÙØ¸ Ø¬Ù†ÙˆØ¨ÛŒ','Ø³Ù„Ù…Ø§Ù† ÙØ§Ø±Ø³ÛŒ','Ø­Ø§ÙØ¸ Ø´Ù…Ø§Ù„ÛŒ','ÙÙ„Ú©Ù‡ Ø§ØµÙ„ÛŒ','ÙÙ„Ú©Ù‡ Ø¹Ù„ÛŒ','Ø³Ø±Ù‚Ù†Ø§Øª','Ø§ÛŒØ°Ù‡','Ø¨Ø§Ø²Ø§Ø±Ø³Ø¨Ø²ÛŒ','Ù…Ù†Ù‚Ù„','Ú©Ø¨Ø§Ø¨'];
    let data=[], flipped=[], matched=0, score=1000, time=40, lock=true, timer, helpUsed=false;

    // Ø³ÛŒØ³ØªÙ… ØµÙˆØªÛŒ
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    function playSound(type) {
        if(audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.connect(gain); gain.connect(audioCtx.destination);

        if(type === 'fire') { // ØµØ¯Ø§ÛŒ Ø´Ø¨ÛŒÙ‡ Ø¨Ù‡ Ø¬Ù„Ø² ÙˆÙ„Ø² Ø¢ØªØ´
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(200, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(800, audioCtx.currentTime + 0.2);
            gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
            osc.start(); osc.stop(audioCtx.currentTime + 0.3);
        } else if(type === 'error') { // ØµØ¯Ø§ÛŒ Ø¬Ø±ÛŒÙ…Ù‡
            osc.type = 'square';
            osc.frequency.setValueAtTime(100, audioCtx.currentTime);
            gain.gain.setValueAtTime(0.2, audioCtx.currentTime);
            gain.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 0.2);
            osc.start(); osc.stop(audioCtx.currentTime + 0.2);
        } else if(type === 'win') {
            osc.type = 'sine';
            osc.frequency.setValueAtTime(400, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(1000, audioCtx.currentTime + 0.5);
            gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gain.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 0.5);
            osc.start(); osc.stop(audioCtx.currentTime + 0.5);
        }
    }

    window.init = () => {
        clearInterval(timer);
        matched=0; score=1000; time=40; flipped=[]; lock=true; helpUsed=false;
        document.getElementById('tm').innerText = time;
        document.getElementById('sc').innerText = score;
        document.getElementById('ov').style.display = 'none';
        document.getElementById('msg').innerText = "Ø­ÙØ¸ Ú©Ù†!";
        
        data = [...locs, ...locs].sort(() => Math.random() - 0.5);
        const grid = document.getElementById('grid');
        grid.innerHTML = data.map((txt, i) => `
            <div class="card flip" id="card-${i}" onclick="flip(this,${i})">
                <div class="card-in">
                    <div class="face back">ØŸ</div>
                    <div class="face front">${txt}</div>
                </div>
            </div>`).join('');

        setTimeout(() => {
            document.querySelectorAll('.card').forEach(c => c.classList.remove('flip'));
            lock = false; startTimer();
            document.getElementById('msg').innerText = "Ø´Ø±ÙˆØ¹!";
        }, 1000);
    };

    function startTimer() {
        timer = setInterval(() => {
            time--;
            updateDisplay();
            if(time === 15 && !helpUsed) showHelp();
            if(time <= 0) end(false);
        }, 1000);
    }

    function updateDisplay() {
        document.getElementById('tm').innerText = Math.max(0, time);
        document.getElementById('sc').innerText = score;
    }

    function showHelp() {
        helpUsed = true;
        document.getElementById('msg').innerText = "Û´ Ø¬ÙØª Ø±Ùˆ Ø´Ø¯! ğŸ”¥";
        let targets = [];
        let revealedWords = 0;
        for(let word of locs) {
            let indices = data.map((v, i) => v === word ? i : -1).filter(i => i !== -1);
            if(!document.getElementById(`card-${indices[0]}`).classList.contains('match')) {
                targets.push(...indices); revealedWords++;
                if(revealedWords === 4) break;
            }
        }
        targets.forEach(idx => document.getElementById(`card-${idx}`).classList.add('flip'));
        setTimeout(() => {
            targets.forEach(idx => {
                let c = document.getElementById(`card-${idx}`);
                if(!c.classList.contains('match')) c.classList.remove('flip');
            });
            document.getElementById('msg').innerText = "Ø³Ø±ÛŒØ¹ Ø¨Ø§Ø´!";
        }, 1500);
    }

    window.flip = (el, i) => {
        if(lock || el.classList.contains('flip') || el.classList.contains('match')) return;
        el.classList.add('flip');
        flipped.push({el, txt: data[i]});
        
        if(flipped.length === 2) {
            lock = true;
            if(flipped[0].txt === flipped[1].txt) {
                matched++; score += 150;
                playSound('fire'); // ØµØ¯Ø§ÛŒ Ø¬ÙØª Ø´Ø¯Ù† (Ø¢ØªØ´)
                flipped.forEach(f => f.el.classList.add('match'));
                flipped = []; lock = false;
                updateDisplay();
                if(matched === locs.length) end(true);
            } else {
                time = Math.max(0, time - 3);
                score = Math.max(0, score - 50);
                playSound('error'); // ØµØ¯Ø§ÛŒ Ø§Ø´ØªØ¨Ø§Ù‡
                const tmEl = document.getElementById('tm');
                tmEl.classList.add('penalty-text');
                updateDisplay();
                setTimeout(() => {
                    flipped.forEach(f => f.el.classList.remove('flip'));
                    flipped = []; lock = false;
                    tmEl.classList.remove('penalty-text');
                }, 500);
            }
        }
    };

    function end(win) {
        clearInterval(timer);
        if(win) playSound('win');
        document.getElementById('ov').style.display = 'flex';
        document.getElementById('final-msg').innerText = win ? "ğŸ† Ø¨Ø±Ù†Ø¯Ù‡ Ø´Ø¯ÛŒ!" : "âŒ› Ø²Ù…Ø§Ù† ØªÙ…Ø§Ù… Ø´Ø¯";
        if(win) {
            document.getElementById('reward').style.display = 'block';
            document.getElementById('wa').href = `https://wa.me/989220730628?text=Ú†Ø§Ù„Ø´ Ø§Ù„Ùˆ Ø°ØºØ§Ù„ Ø±Ùˆ Ø¨Ø§ Ø§Ù…ØªÛŒØ§Ø² ${score} Ø¨Ø±Ø¯Ù…!`;
        }
    }
    init();
})();
</script>
</body>
</html>
